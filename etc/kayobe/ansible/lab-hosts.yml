---
- hosts: all
  gather_facts: false
  tasks:
    - name: Update /etc/hosts for lab entities
      local_action:
        module: blockinfile
        path: /etc/hosts
        block: |
          {% for item in groups['overcloud'] + groups['seed'] %}
          {{ aio_ips[item] }} {{ item }}
          {% endfor %}
      run_once: true
      become: true

    - name: Update ssh config for lab entities
      local_action:
        module: blockinfile
        path: "{{ lookup('env','HOME') }}/.ssh/config"
        create: true
        mode: 0600
        block: |
          {% for item in groups['overcloud'] + groups['seed'] %}
          Host {{ item }}
              User stack
          {% endfor %}
      run_once: true

